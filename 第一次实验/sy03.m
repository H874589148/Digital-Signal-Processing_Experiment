n=0:50;
A=444.128;
a=50*sqrt(2)*pi;
w0=50*sqrt(2)*pi;
T=1/1000;
x=A*exp(-a*n*T).*sin(w0*n*T);
ha=[ones(1,10) zeros(1,41)];
k=-25:25;
X=x*(exp(-j*pi/12.5)).^(n'*k);
magX=abs(X);
subplot(4,2,1);stem(magX);title('输入信号的幅度谱');
angX=angle(X);
subplot(4,2,2);stem(angX);title('输入信号的相位谱')
Hb=ha*(exp(-j*pi/12.5)).^(n'*k);
magHb=abs(Hb);
subplot(4,2,3);stem(magHb);title('系统响应的幅度谱');
angHb=angle(Hb);
subplot(4,2,4);stem(angHb);title('系统响应的相位谱')
y=conv(x,ha);
n=1:101;k=1:99;
Y=y*(exp(-j*pi/12.5)).^(n'*k);
magY=abs(Y);
subplot(4,2,5);stem(magY);title('卷积得到输出信号的幅度谱');
angY=angle(Y);
subplot(4,2,6);stem(angY);title('卷积得到输出信号的相位谱')
XHb=X.*Hb;
subplot(4,2,7);stem(abs(XHb));title('x(n)的幅度谱与hb(n)幅度谱相乘的幅度谱');
subplot(4,2,8);stem(angle(XHb));title('x(n)的幅度谱与hb(n)幅度谱相乘的相位谱');