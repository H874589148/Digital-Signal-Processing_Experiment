%---------------------------------------------------------------------------
% rounding: 完成给定序列的量化，并计算量化误差的信噪比。量化采用舍入方式。
% 输入   a: 需量化的序列，
%        n: 浮点位数
% 输出 aeq: 量化后的序列
%---------------------------------------------------------------------------
function aeq=rounding(a,n)

[m1,m2]=size(a);
for i = 1:m1
    for j = 1:m2
        r=floor(log2(abs(a(i,j))+eps));
        r = max(0,min(r)+1);
        b = round(abs(a(i,j))*2^(n-r));
        aeq(i,j) = sign(a(i,j))*b/2^(n-r);   
     end
end



